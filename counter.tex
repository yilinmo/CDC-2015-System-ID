  \section{Low-Rank Controller Design against KPA}
  \label{sec:countermeasure}

  By Theorem~\ref{thm:nonidentifiable}, one way to prevent the adversary from identifying $\mathcal G(z)$ is to enforce the factorization \eqref{eq:factorization} on the controller transfer function $\mK(z)$. Let us define the following ``virtual'' control input:
  \begin{equation}
    \tilde u(k) \triangleq \tilde{\mathcal K}(z) y(k). 
    \label{eq:tildeudef}
  \end{equation}
  Hence, $u(k) = \mathcal K(z) y(k) =  F \tilde u(k)$. The factorization on $\mK(z)$ implies the CPS diagram illustrated in Fig~\ref{fig:factorization}.

  Since we are restricting ourselves to use a low-rank controller, the performance of the system may not be optimal. In this section, we consider the problem of optimizing the following infinite horizon LQG performance:
  \begin{equation}
    J = \limsup_{T\rightarrow \infty}\frac{1}{T}\min_{u(k)}\mathbb{E}\left[\sum_{k=0}^{T-1} x(k)^TWx(k)+u(k)^TUu(k)\right],
    \label{eq:lqgcost}
  \end{equation}
  under the constraint that $F \in \mathbb R^{p\times q}$ where $q$ is given. The $W,\,U$ matrices are assumed to be positive semidefinite. We shall first consider how to design $\tilde {\mathcal K}(z)$ when $F$ is given. We then provide a heuristic algorithm to compute the optimal $F$ based on convex relaxation.

